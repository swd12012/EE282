### Homework 3
##### Sam Du, EE282 Fall 2020

___

#### Summarize a genome assembly

**Data**: Downloaded the most current _D. melanogaster_ genome (dmel-all-chromosome-r6.36.fasta.gz) from [FlyBase](ftp://ftp.flybase.net/genomes/Drosophila_melanogaster/dmel_r6.36_FB2020_05/fasta/).

`wget ftp://ftp.flybase.net/genomes/Drosophila_melanogaster/dmel_r6.36_FB2020_05/fasta/dmel-all-chromosome-r6.36.fasta.gz`

**Check Data Integrity**: Used md5sum to check the data integrity of my download. The checksum [provided](ftp://ftp.flybase.net/genomes/Drosophila_melanogaster/dmel_r6.36_FB2020_05/fasta/md5sum.txt) was an md5sum.

Therefore, I ran the following code:
```bash   
cd /data/homezvol2/swdu/ee282/homework/hw3/data/raw
md5sum dmel-all-chromosome-r6.36.fasta.gz
```

The output was `fbd2855a20c3610050ff2496dd975821  dmel-all-chromosome-r6.36.fasta.gz`

This was the same checksum as the provided checksum that was linked above.

**Genome Assembly Summary**: I used the faSize tool to explore the gzipped fasta file. After I ran the following code...

```bash
faSize dmel-all-chromosome-r6.36.fasta.gz 
```

... the output was:

```bash
143726002 bases (1152978 N's 142573024 real 142573024 upper 0 lower) in 1870 sequences in 1 files
Total size: mean 76858.8 sd 1382100.2 min 544 (211000022279089) max 32079331 (3R) median 1577
N count: mean 616.6 sd 6960.7
U count: mean 76242.3 sd 1379508.4
L count: mean 0.0 sd 0.0
%0.00 masked total, %0.00 masked real
```

To summarize:

1. There were 143,726,002 nucleotides (143.7Mb).
2. There were 1,152,978 N's (1.1Mb).
3. There were 1870 sequences [scaffolds?].

An interesting output was that the 3R arm was the longest.

___

#### Summarize an annotation file

**Data**: I downloaded the most current _D. melanogaster_ gtf file (dmel-all-r6.36.gtf.gz) from [FlyBase](ftp://ftp.flybase.net/genomes/Drosophila_melanogaster/dmel_r6.36_FB2020_05/gtf/dmel-all-r6.36.gtf.gz) by issuing the following command:

`wget ftp://ftp.flybase.net/genomes/Drosophila_melanogaster/dmel_r6.36_FB2020_05/gtf/dmel-all-r6.36.gtf.gz`

**Check Data Integrity**: I used md5sum to check the data integrity of my download. The [provided checksum](ftp://ftp.flybase.net/genomes/Drosophila_melanogaster/dmel_r6.36_FB2020_05/gtf/md5sum.txt) was generated by md5sum, and the only line in the checksum file was `9085d2f3d2449fc1f6159015511240b8  dmel-all-r6.36.gtf.gz`.

When I ran `md5sum dmel-all-r6.36.gtf.gz` on my downloaded file, the output was `9085d2f3d2449fc1f6159015511240b8  dmel-all-r6.36.gtf.gz`. Thus, there was no loss of data integrity upon download.

I also gunzipped the file: `gunzip dmel-all-r6.36.gtf`.

To summarize the features of each type, sorted from most to least common, I ran the following script:

```bash
grep -v "^#" dmel-all-r6.36.gtf \
| cut -f3 \
| sort\
| uniq -c\
|sort -rn
```

I removed lines that began with '#', selected field 3 that contained the features, sorted, counted unique features and appended counts with `-c`, and then sorted again in reverse numerical order.

The output of this set of commands was:

```
 189268 exon
 162578 CDS
  46664 5UTR
  33629 3UTR
  30812 start_codon
  30754 stop_codon
  30728 mRNA
  17875 gene
   3047 ncRNA
    485 miRNA
    366 pseudogene
    312 tRNA
    300 snoRNA
    262 pre_miRNA
    115 rRNA
     32 snRNA
```

To count only the genes per chromosome arm and to sort in reverse numerical order, I ran the following pipeline:

```bash
grep -v "^#" dmel-all-r6.36.gtf \
| cut -f1,3 \
| sort -k2,2\
| grep "\<gene\>"\
| grep '[234LRXY]'\
| grep -v '[\d{15}]'\
| uniq -c\
| sort -rn
```

I cut out fields 1 and 3 as they contained features and chromosomes. Because I only wanted to look at chromosomal arms, and there were rDNA and mitochondrial genomes, etc, in the pipeline, I filtered in chromosome arms X, Y, 2L, 2R, 3L, 3R, and 4 with `grep '[234LRXY]'`. I was unsure of what the other scaffolds were. They were all 15 digit numbers, so I excluded them by adding in `grep -v '[\d{15}]'`. 

The output of this pipeline was:

```
   4225 3R   gene
   3653 2R  gene
   3516 2L  gene
   3486 3L  gene
   2691 X   gene
    114 4   gene
    113 Y   gene
```
